
<!--
<script type="text/javascript">
$(document).ready(function(){
    console.log("PETE IS HERE\n")
    console.log(">> " + $("#foo").text())
    $(".dropdown").on("show.bs.dropdown", function(e){
        console.log("FIRING ....")
        var linkText = $(e.relatedTarget).text(); // Get the link text
        alert("Click on OK button to view the dropdown menu for - " + linkText);
    });

    $(".dropdown").on("hide.bs.dropdown", function(e){
        console.log("FIRING for " + e.relatedTarget)
        var linkText = $(e.relatedTarget).text(); // Get the link text
        console.log("PETE FOUND " + linkText)
        // alert("Click on OK button to view the dropdown menu for - " + linkText);
    });

});
</script>
-->

{{if .HasHeader}}
    <div class="row">
        <div class="col-xs-8">
            <h2> Domain information for {{.Dinfo.Domain}} </h2>
            <table class="console-table table table-striped table-condensed">
                <tr>
                    <th class="col-xs-3"> Field </th>
                    <th class="col-xs-3"> Value </th>
                    <th class="col-xs-2"> &nbsp; </th> 
                </tr>
                
                <tr>
                    <td> Domain </td>
                    <td>  {{.Dinfo.Domain}} </td>
                    <td> &nbsp; </td>
                </tr>
                
                <tr>
                    <td> Exclude Reason (if excluded) </td>
                    <td>  {{.Dinfo.ExcludeReason}} </td>
                    <td > <a href="{{.ExcludeLink}}" style="width: 100%; background-color: {{.ExcludeColor}};" 
                             class="btn btn-info btn-large"> 
                               {{.ExcludeTag}}
                          </a> 
                    </td>
                </tr>
                
                <tr>
                    <td> Last Claimed By Fetcher </td>
                    <td>  {{ftime2 .Dinfo.ClaimTime}} </td>
                    <td> &nbsp; </td>                    
                </tr>
                
                <tr>
                    <td> Current Fetcher Claim ID </td>
                    <td>  {{fuuid .Dinfo.ClaimToken}} </td>
                    <td> &nbsp; </td>                    
                </tr>
                
                <tr>
                    <td> Total Unique Links </td>
                    <td>  {{.Dinfo.NumberLinksTotal}} </td>
                    <td> &nbsp; </td>                    
                </tr>
                
                <tr>
                    <td> Links Dispatched </td>
                    <td>  {{.Dinfo.NumberLinksQueued}} </td>
                    <td> &nbsp; </td>                    
                </tr>

                <tr>
                    <td> Unique Links Crawled </td>
                    <td>  {{.NumberCrawled}} </td>
                    <td> &nbsp; </td>                    
                </tr>

                <tr>
                    <td> Unique Links Not Yet Crawled </td>
                    <td>  {{.Dinfo.NumberLinksUncrawled}} </td>
                    <td> &nbsp; </td>                    
                </tr>

                <tr>
                    <td> Priority </td>
                    <td>  {{.Dinfo.Priority}} </td>
                    <td> 
                        <div class="btn-group dropdown" style="width: 100%;">

                            <button id="foo" type="button" style="width: 100%; color: white; background-color: green;"
                                    data-toggle="dropdown" class="btn btn-default dropdown-toggle">
                                &nbsp; &nbsp; Set Priority &nbsp; &nbsp;
                                <span class="caret"></span>
                            </button> 

                            <ul class="dropdown-menu">
                                {{range .PriorityLinks}}
                                    <li><a href="{{.Link}}" style="text-align: center;">{{.Text}}</a></li>
                                {{end}}
                            </ul>
                        </div>
                    </td>                    
                </tr>                

            </table>
        </div>
    </div>
    <br>
{{end}}

{{if .HasLinks}}
    <div class="row" style="width: 90%;">
        {{if .AltTitle}}
            <h2> Searched for links </h2>
        {{else}}
            <h2> Links for domain {{.Dinfo.Domain}} {{.FilterRegexSuffix}}</h2>
        {{end}}
        <table class="console-table table table-condensed table-striped">
            <thead>
                <th class="col-xs-4"> Link </th>
                <th class="col-xs-1"> Status </th>
                <th class="col-xs-1"> Error? </th>
                <th class="col-xs-1"> Excluded by robots.txt? </th>
                <th class="col-xs-2"> Last Fetch </th>
            </thead>
            <tbody>
                {{range $i, $linfo := .Linfos}}
                    {{$hl := index $.HistoryLinks $i}}
                    <tr>
                        <td> <a href="{{$hl}}"> {{$linfo.URL}} </a> </td>
                        <td> {{statusText $linfo.Status}} </td>
                        <td> {{yesOnFilled $linfo.Error}} </td>
                        <td> {{yesOnTrue $linfo.RobotsExcluded}} </td>
                        <td> {{ftime $linfo.CrawlTime}} </td>
                    </tr>
                {{end}}
            </tbody>
        </table>
    <div>

    {{if not .DisableButtons}}
        <div style="width: 90%;" class="row">

            <a href="" class="col-xs-3 btn btn-info btn-large {{.PrevButtonClass}}" onclick="window.history.back()">
                      <i class="icon-white icon-backward"></i> Previous</a>

            <div class="col-xs-1"></div>

            <a href="/links/{{.Dinfo.Domain}}/{{.NextSeedURL}}{{.FilterURLSuffix}}" class="col-xs-3 btn btn-info btn-large {{.NextButtonClass}}">
                      <i class="icon-white icon-forward"></i> Next </a>

        </div>
    {{end}}

{{else}}
    <div class="row">
        <h2> No links for domain {{.Dinfo.Domain}} {{.FilterRegexSuffix}}</h2>
    </div>
{{end}}

